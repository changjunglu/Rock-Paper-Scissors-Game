# BRD v3.0-AC - 2025-07-25

## 1. 文檔信息
- **目的**：提供剪刀石頭布追逐遊戲的商業需求文檔，整合詳細驗收標準(AC)，確保業務目標與技術實現一致性。
- **內容**：
  - 文檔版本歷史：
    - v1.0 2025-07-15 建立初稿（負責人：AI）
    - v2.0 2025-07-16 重構更新，基於實際實現（負責人：AI）
    - v3.0-AC 2025-07-25 整合AC驗收標準，強化業務需求可測試性（負責人：AI）
  - 文檔分發對象：
    - 遊戲開發團隊、產品經理、UI/UX設計師、測試人員、品質保證團隊
  - AC關聯文件：
    - 詳細驗收標準：`userstory_func.md`
    - 高階使用者故事：`userstory_high.md`

## 2. 項目概述
- **項目描述**：
  - 本產品是一款創新的剪刀石頭布追逐遊戲，結合傳統剪刀石頭布規則與即時動作遊戲元素。玩家與AI進行對戰，雙方在800x600像素的遊戲區域內移動，當屬性相剋且發生碰撞時獲得分數。遊戲具備4種不同AI策略、可配置的遊戲參數，以及累積分數系統。
- **業務目標**：
  - 提供創新且具挑戰性的遊戲體驗，滿足不同技能水平的玩家需求
  - 通過多種AI策略和可配置參數提升遊戲重玩性
  - 建立穩定、流暢的遊戲平台，支援未來功能擴展
- **用戶群體**：
  - 休閒遊戲愛好者、學生、一般大眾、喜愛挑戰AI的玩家

## 3. 功能需求
- **核心功能**：
  1. 玩家與AI隨機分配剪刀、石頭或布屬性
  2. 可配置RPS變換間隔（3秒/5秒/10秒）
  3. 玩家方向鍵控制圓圈移動，AI策略自動移動
  4. 四種AI策略：積極、謹慎、隨機、進階
  5. 碰撞且屬性相剋時獲得分數
  6. 累積分數系統，可配置勝利分數（1/3/5/7分）
  7. 實時遊戲狀態更新和計時器顯示
- **次要功能**：
  1. 手勢emoji視覺化顯示（✊✋✌️）
  2. 玩家與AI資訊面板顯示
  3. 遊戲暫停/重啟功能
  4. 遊戲設定面板
  5. 勝負結果顯示
  6. AI牆角脫困和移動預測系統
- **用戶故事/使用場景**：
  - 玩家進入遊戲後，選擇AI策略和遊戲參數，透過鍵盤操作移動，嘗試在RPS相剋時碰觸AI獲得分數，先達到目標分數者獲勝。

## 4. 用戶界面需求
- **界面原型/草圖**：
  - 上方：遊戲設定面板（AI策略、RPS間隔、勝利分數）
  - 中央：800x600像素遊戲區域，顯示玩家（藍色）和AI（紫色）圓圈
  - 左右：玩家和AI資訊面板（分數、當前RPS）
  - 下方：遊戲控制按鈕（暫停/重啟）和狀態顯示
- **用戶流程圖**：
  - 進入遊戲 → 選擇設定 → 遊戲開始 → RPS分配 → 移動操作 → 碰撞檢測 → 分數更新 → 達到勝利分數 → 顯示結果
- **設計指南**：
  - 色彩：玩家藍色主題、AI紫色主題、手勢emoji清晰顯示
  - 字體：清晰易讀，重要資訊突出顯示
  - 佈局：直覺式設計，操作簡單明瞭

## 5. 系統需求
- **系統架構**：
  - React 18 + TypeScript 5 單頁應用
  - Canvas 2D API遊戲渲染
  - 本地狀態管理，無需後端
- **數據流程圖**：
  - 初始化遊戲狀態 → 玩家輸入/AI計算 → 位置更新 → 碰撞檢測 → RPS判斷 → 分數更新 → 勝利檢查 → 狀態更新
- **技術堆棧**：
  - React 18, TypeScript 5, Vite 7, ESLint, Canvas 2D API
- **與其他系統的集成需求**：
  - 無外部系統依賴，完全本地運行

## 6. 數據需求
- **數據模型**：
  - Player: {id, x, y, radius, rps, score}
  - GameState: {player, ai, status, timer, round, winner, rpsChangeTimer, winScore}
  - AIType: 'aggressive' | 'cautious' | 'random' | 'advanced'
  - RPSChangeInterval: 3 | 5 | 10
  - WinScore: 1 | 3 | 5 | 7
- **數據存儲需求**：
  - 遊戲狀態儲存在React狀態中
  - 未來可擴展localStorage持久化
- **數據處理需求**：
  - 60fps遊戲狀態更新
  - 實時碰撞檢測
  - AI移動計算和預測
  - RPS相剋判斷
- **數據遷移計劃**：
  - 目前無需遷移，架構支援未來擴展

## 7. 非功能性需求
- **性能需求**：
  - 60fps穩定運行，延遲16ms以內
  - 記憶體使用50MB以內，CPU使用5%以內
  - 遊戲載入時間3秒以內
- **安全需求**：
  - 無需登入，無個資處理
  - 純前端運行，無資料外傳
- **可擴展性需求**：
  - 模組化設計，易於新增AI策略
  - 支援新增遊戲模式和規則
  - 架構支援未來多人模式
- **可維護性需求**：
  - TypeScript類型安全
  - 清晰的程式結構和模組化設計
  - 完整的錯誤處理機制

## 8. 實施計劃
- **里程碑和時間線**：
  1. 需求確認與設計（已完成 - 2025-07-15）
  2. 遊戲原型開發（已完成 - 2025-07-16）
  3. AI系統優化（已完成 - 2025-07-16）
  4. UI/UX完善（已完成 - 2025-07-16）
  5. 未來擴展計劃（多人模式、音效系統、成就系統）
- **優先級排序**：
  - 已完成：核心遊戲機制、AI系統、UI介面
  - 未來：音效系統、成就系統、多人模式
- **測試計劃**：
  - 功能測試：所有AI策略、遊戲機制、UI操作
  - 性能測試：60fps穩定性、記憶體使用、長時間運行
  - 兼容性測試：多瀏覽器支援

## 9. 術語表
- **RPS**：Rock-Paper-Scissors（剪刀石頭布）
- **AI策略**：電腦玩家的行為模式，包括積極、謹慎、隨機、進階四種
- **屬性相剋**：石頭勝剪刀、剪刀勝布、布勝石頭
- **牆角脫困**：AI被困在遊戲區域邊界時的自動脫困機制
- **移動預測**：AI預測玩家移動軌跡的智能系統
- **累積分數**：每次勝利獲得1分，累積到目標分數獲勝

## 10. 風險評估
- **技術風險**：
  - 性能瓶頸：通過優化渲染和狀態管理已解決
  - 瀏覽器兼容性：使用標準API，支援主流瀏覽器
- **產品風險**：
  - 用戶接受度：提供多種AI策略和難度選項
  - 遊戲平衡性：AI策略經過調整，提供合理挑戰
- **市場風險**：
  - 競爭產品：獨特的遊戲機制和AI系統提供差異化

## 11. 成功指標與AC關聯

### 11.1 技術指標
| 指標項目 | 目標值 | 對應AC驗證點 | 測試方法 |
|----------|--------|--------------|----------|
| 遊戲運行穩定性 | 99.9% | F02-1 AC5, F03-1 AC8 | 長時間運行測試 |
| 平均幀率 | 60fps | 所有Story AC8 | 效能監控工具 |
| 記憶體使用 | <50MB | F04-1 AC7, F08-1 AC8 | Chrome DevTools |
| 按鍵回應延遲 | <16ms | F02-1 AC5 | 輸入延遲測試 |
| AI策略正常運作 | 100% | F04-1 AC1-AC8 | 自動化功能測試 |

### 11.2 用戶體驗指標  
| 指標項目 | 目標值 | 對應AC驗證點 | 驗證方法 |
|----------|--------|--------------|----------|
| 10秒理解遊戲 | 90%用戶 | F06-1 AC1,AC2 | 可用性測試 |
| AI策略體驗率 | 80%用戶 | F04-1 AC1,AC6 | 用戶行為分析 |
| 參數調整率 | 70%用戶 | F07-1 AC1,AC2 | 使用統計 |
| 重複遊玩率 | 60%用戶 | F03-1 AC5, F08-1 AC5 | 留存分析 |

### 11.3 可訪問性指標
| 指標項目 | 目標值 | 對應AC驗證點 | 驗證方法 |
|----------|--------|--------------|----------|
| WCAG AA合規 | 100% | F09-1 AC1-AC8 | 可訪問性審查 |
| 鍵盤導航 | 100%功能 | F07-1 AC8, F09-1 AC2 | 鍵盤測試 |
| 色彩對比度 | ≥4.5:1 | F06-1 AC3, F09-1 AC1 | 對比度工具 |
| 螢幕閱讀器支援 | 100%元素 | F09-1 AC3 | NVDA/JAWS測試 |

### 11.4 業務成果指標
- **學習成本**: 新用戶5分鐘內掌握基本操作 → AC: F06-1 AC1,AC2 + F02-1 AC1
- **挑戰性平衡**: AI勝率控制在40-60%範圍 → AC: F04-1 AC2-AC5 行為驗證
- **重玩價值**: 不同AI策略提供差異化體驗 → AC: F04-1 AC8 + F08-1 AC1-AC8
- **技術穩定性**: 零重大功能缺陷 → AC: 所有Story通過驗收測試

## 12. AC品質保證框架

### 12.1 驗收標準完整性檢核
- [x] 32個核心AC涵蓋所有業務需求
- [x] Given-When-Then格式保證可測試性  
- [x] 效能、安全、可訪問性非功能需求完整
- [x] 邊界條件和異常情況處理

### 12.2 業務目標追蹤矩陣
| 業務目標 | 對應功能 | AC驗證點 | 成功指標 |
|----------|----------|----------|----------|
| 創新遊戲體驗 | RPS+追逐機制 | F01-1 AC1-AC5, F03-1 AC1-AC8 | 90%理解率 |
| AI智慧挑戰 | 4種AI策略 | F04-1 AC1-AC8, F05-1 AC1-AC8 | 80%體驗率 |
| 流暢操作 | 60fps運行 | 所有AC8效能要求 | 技術指標達成 |
| 普及可用 | 可訪問性設計 | F09-1 AC1-AC8 | WCAG AA合規 |

## 13. 簽署確認
| 角色 | 姓名/簽名 | 日期 | 版本 | AC審查狀態 |
|------|-----------|------|------|------------|
| 產品經理 | AI | 2025-07-25 | v3.0-AC | ✅已確認 |
| 開發負責人 | AI | 2025-07-25 | v3.0-AC | ✅已確認 |
| UI/UX設計師 | AI | 2025-07-25 | v3.0-AC | ✅已確認 |
| 測試負責人 | AI | 2025-07-25 | v3.0-AC | ✅已確認 |
| 品質保證經理 | AI | 2025-07-25 | v3.0-AC | ✅已確認 |